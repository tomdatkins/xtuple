language: node_js
node_js:
  - "0.8"

install:
  - "cp test/lib/sample_login_data.js test/lib/login_data.js"
  - "cd .."
  - "git clone git://github.com/xtuple/xtuple.git --recursive"
  - "cd xtuple"
  - "bash scripts/install_xtuple.sh -ipn"
  - "sudo apt-get install libdigest-hmac-perl"
  - "curl https://s3.amazonaws.com/xtuple_masterref/s3curl.pl > s3curl.pl"
  - "chmod u+x s3curl.pl"
  - "./s3curl.pl"
  - "cp test/lib/demo-test.backup ../private-extensions/test/lib"
  - "cd ../private-extensions"
  - "npm install"
  - "npm run-script test-build"
  - "cd ../xtuple"

before_script:
  - "cd node-datasource"
  - "node main.js &"
  - "sleep 10"
  - "cd .."

script:
  - "npm run-script test"
  - "cd ../private-extensions"
  - "npm run-script test"
