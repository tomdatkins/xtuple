<!DOCTYPE openRPTDef>
<report>
 <title>W/O Effort By Work Order</title>
 <name>WOEffortByWorkOrder</name>
 <description></description>
 <grid>
  <snap/>
  <show/>
  <x>0.05</x>
  <y>0.05</y>
 </grid>
 <size>Letter</size>
 <portrait/>
 <topmargin>50</topmargin>
 <bottommargin>50</bottommargin>
 <rightmargin>50</rightmargin>
 <leftmargin>50</leftmargin>
 <querysource>
  <name>head</name>
  <sql>SELECT formatWONumber(wo_id) AS wonumber,
       warehous_code as warehouse,
       item_number, item_descrip1,
       item_descrip2, uom_name AS iteminvuom,
       wo_status AS status,
       fetchmetrictext('TimeAttendanceMethod') as label 
  FROM wo, itemsite, item, whsinfo, uom
 WHERE ((wo_itemsite_id=itemsite_id)
   AND (itemsite_item_id=item_id)
   AND (item_inv_uom_id=uom_id)
   AND (itemsite_warehous_id=warehous_id)
   AND (wo_id=&lt;? value("wo_id") ?>) );</sql>
 </querysource>
 <querysource>
  <name>detail</name>
  <sql>SELECT wotc_id, COALESCE(wotc_emp_code, wotc_username,'') as wotc_username,
	              wooper_seqnumber || ' - ' || wooper_descrip1 || ' - ' ||
	                                           wooper_descrip2 AS wooper, 
	              formatDateTime(wotc_timein) AS timein,
	              formatDateTime(wotc_timeout) AS timeout,
	              NULL::text AS setup_time, NULL::text AS run_time,
	              xtmfg.wotcTime(wotc_id) AS wo_effort 
	         FROM xtmfg.wotc LEFT OUTER JOIN 
	            xtmfg.wooper ON (wotc_wooper_id=wooper_id) 
	       WHERE ((wotc_wo_id=&lt;? value("wo_id") ?>)
	         AND  (wotc_id NOT IN (SELECT DISTINCT wooperpost_wotc_id 
	                               FROM xtmfg.wooperpost
	                               WHERE (wooperpost_wo_id=&lt;? value("wo_id") ?>)
	                                 AND (wooperpost_wotc_id IS NOT NULL)))) 
	       UNION 
	       SELECT wotc_id, COALESCE(wotc_emp_code, wotc_username,'') as wotc_username,
	              CAST(wooperpost_seqnumber AS TEXT) AS wooper, 
	              formatDateTime(wotc_timein) AS timein,
	              formatDateTime(wotc_timeout) AS timeout,
	              formatQty(wooperpost_sutime) AS setup_time,
	              formatQty(wooperpost_rntime) AS run_time,
	              xtmfg.wotcTime(wotc_id) AS wo_effort 
	         FROM xtmfg.wotc, xtmfg.wooperpost 
	       WHERE ((wotc_wo_id=&lt;? value("wo_id") ?>)
	         AND  (wooperpost_wotc_id=wotc_id)) 
	       ORDER BY timein, timeout;</sql>
 </querysource>
 <querysource>
  <name>times</name>
  <sql>SELECT formatDateTime(MIN(wotc_timein)) AS timein,
     formatDateTime(MAX(wotc_timeout)) AS timeout,
     xtmfg.woTimeByWo(wotc_wo_id) AS wo_effort
FROM xtmfg.wotc LEFT OUTER JOIN xtmfg.wooper ON (wotc_wo_id = wooper_wo_id)
WHERE (wotc_wo_id=&lt;? value("wo_id") ?>)
GROUP BY wotc_wo_id;</sql>
 </querysource>
 <querysource>
  <name>totals</name>
  <sql>SELECT	formatQty(SUM(wooper_suconsumed)) AS setup_time,
	formatQty(SUM(wooper_rnconsumed)) AS run_time,
	SUM(wooper_suconsumed) + SUM(wooper_rnconsumed) -
	    intervalToMinutes(xtmfg.woTimeByWo(wooper_wo_id)) AS variance
FROM xtmfg.wooper
WHERE (wooper_wo_id=&lt;? value("wo_id") ?>)
GROUP BY wooper_wo_id;</sql>
 </querysource>
 <rpthead>
  <height>217</height>
  <label>
   <rect>
    <x>-5</x>
    <y>55</y>
    <width>100</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Work Order #:</string>
  </label>
  <label>
   <rect>
    <x>525</x>
    <y>202</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Run Time</string>
  </label>
  <field>
   <rect>
    <x>100</x>
    <y>140</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>item_descrip2</column>
   </data>
  </field>
  <label>
   <rect>
    <x>50</x>
    <y>202</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Operation</string>
  </label>
  <field>
   <rect>
    <x>315</x>
    <y>100</y>
    <width>150</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>iteminvuom</column>
   </data>
  </field>
  <label>
   <rect>
    <x>450</x>
    <y>202</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Setup Time</string>
  </label>
  <label>
   <rect>
    <x>10</x>
    <y>75</y>
    <width>85</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Warehouse:</string>
  </label>
  <field>
   <rect>
    <x>100</x>
    <y>55</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>wonumber</column>
   </data>
  </field>
  <label>
   <rect>
    <x>260</x>
    <y>100</y>
    <width>50</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>UOM:</string>
  </label>
  <label>
   <rect>
    <x>250</x>
    <y>2</y>
    <width>497</width>
    <height>37</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>18</size>
    <weight>bold</weight>
   </font>
   <right/>
   <vcenter/>
   <string>W/O Effort By Work Order</string>
  </label>
  <line>
   <xstart>2</xstart>
   <ystart>215</ystart>
   <xend>751</xend>
   <yend>215</yend>
   <weight>2</weight>
  </line>
  <label>
   <rect>
    <x>300</x>
    <y>202</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Clocked Out</string>
  </label>
  <label>
   <rect>
    <x>150</x>
    <y>202</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Clocked In</string>
  </label>
  <label>
   <rect>
    <x>700</x>
    <y>200</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Effort</string>
  </label>
  <field>
   <rect>
    <x>100</x>
    <y>120</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>item_descrip1</column>
   </data>
  </field>
  <label>
   <rect>
    <x>10</x>
    <y>100</y>
    <width>85</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Item Number:</string>
  </label>
  <field>
   <rect>
    <x>100</x>
    <y>75</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>warehouse</column>
   </data>
  </field>
  <field>
   <rect>
    <x>100</x>
    <y>100</y>
    <width>150</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>item_number</column>
   </data>
  </field>
  <field>
   <rect>
    <x>0</x>
    <y>202</y>
    <width>50</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>head</query>
    <column>label</column>
   </data>
  </field>
 </rpthead>
 <pghead>
  <firstpage/>
  <height>6</height>
 </pghead>
 <pghead>
  <height>17</height>
  <label>
   <rect>
    <x>0</x>
    <y>0</y>
    <width>50</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>User</string>
  </label>
  <label>
   <rect>
    <x>400</x>
    <y>0</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Clocked Out</string>
  </label>
  <label>
   <rect>
    <x>550</x>
    <y>0</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Setup Time</string>
  </label>
  <label>
   <rect>
    <x>700</x>
    <y>0</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Effort</string>
  </label>
  <label>
   <rect>
    <x>625</x>
    <y>0</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Run Time</string>
  </label>
  <label>
   <rect>
    <x>50</x>
    <y>0</y>
    <width>200</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <string>Operation</string>
  </label>
  <label>
   <rect>
    <x>250</x>
    <y>0</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Clocked In</string>
  </label>
  <line>
   <xstart>1</xstart>
   <ystart>12</ystart>
   <xend>750</xend>
   <yend>12</yend>
   <weight>2</weight>
  </line>
 </pghead>
 <section>
  <name>detail</name>
  <detail>
   <key>
    <query>detail</query>
   </key>
   <height>15</height>
   <field>
    <rect>
     <x>0</x>
     <y>0</y>
     <width>50</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>wotc_username</column>
    </data>
   </field>
   <field>
    <rect>
     <x>300</x>
     <y>0</y>
     <width>150</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>timeout</column>
    </data>
   </field>
   <field>
    <rect>
     <x>150</x>
     <y>0</y>
     <width>150</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>timein</column>
    </data>
   </field>
   <field>
    <rect>
     <x>50</x>
     <y>0</y>
     <width>100</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>normal</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>wooper</column>
    </data>
   </field>
   <field>
    <rect>
     <x>525</x>
     <y>0</y>
     <width>75</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>run_time</column>
    </data>
   </field>
   <field>
    <rect>
     <x>450</x>
     <y>0</y>
     <width>75</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>setup_time</column>
    </data>
   </field>
   <field>
    <rect>
     <x>600</x>
     <y>0</y>
     <width>150</width>
     <height>15</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>wo_effort</column>
    </data>
   </field>
  </detail>
 </section>
 <pgfoot>
  <height>16</height>
  <label>
   <rect>
    <x>5</x>
    <y>0</y>
    <width>80</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Report Date:</string>
  </label>
  <field>
   <rect>
    <x>90</x>
    <y>0</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>Context Query</query>
    <column>report_date</column>
   </data>
  </field>
  <field>
   <rect>
    <x>705</x>
    <y>0</y>
    <width>40</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>Context Query</query>
    <column>page_number</column>
   </data>
  </field>
  <label>
   <rect>
    <x>620</x>
    <y>0</y>
    <width>80</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Page:</string>
  </label>
 </pgfoot>
 <rptfoot>
  <height>32</height>
  <field>
   <rect>
    <x>150</x>
    <y>10</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>times</query>
    <column>timein</column>
   </data>
  </field>
  <label>
   <rect>
    <x>0</x>
    <y>10</y>
    <width>104</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <string>W/O Summary</string>
  </label>
  <field>
   <rect>
    <x>525</x>
    <y>10</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>totals</query>
    <column>run_time</column>
   </data>
  </field>
  <field>
   <rect>
    <x>300</x>
    <y>10</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>times</query>
    <column>timeout</column>
   </data>
  </field>
  <field>
   <rect>
    <x>450</x>
    <y>10</y>
    <width>75</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>totals</query>
    <column>setup_time</column>
   </data>
  </field>
  <field>
   <rect>
    <x>600</x>
    <y>10</y>
    <width>150</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>times</query>
    <column>wo_effort</column>
   </data>
  </field>
 </rptfoot>
</report>
