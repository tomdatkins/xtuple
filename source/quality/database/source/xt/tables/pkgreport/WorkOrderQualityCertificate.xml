<!DOCTYPE openRPTDef>
<report>
 <title>Work Order Quality Certificate</title>
 <name>WorkOrderQualityCertificate</name>
 <description>Summary of tests completed across operations etc, linked to the selected Work Order.  Covers sub-component tests as well.</description>
 <grid>
  <snap/>
  <show/>
  <x>0.05</x>
  <y>0.05</y>
 </grid>
 <size>A4</size>
 <portrait/>
 <topmargin>50</topmargin>
 <bottommargin>50</bottommargin>
 <rightmargin>50</rightmargin>
 <leftmargin>50</leftmargin>
 <querysource>
  <name>head</name>
  <sql>SELECT crmacct_number as customer_number,
       crmacct_name as customer,
       prj_name as project_name,
       item_number,
       item_descrip1 as item_description,
       qthead_ordnumber as work_order
FROM xt.qthead
  JOIN item ON (qthead.qthead_item_id = item_id) 
  JOIN wo ON (split_part(qthead.qthead_ordnumber,'-',1)::integer = wo.wo_number
              AND split_part(qthead.qthead_ordnumber,'-',2)::integer = wo.wo_subnumber)
  LEFT OUTER JOIN prj ON (wo.wo_prj_id = prj.prj_id ) 
  LEFT OUTER JOIN crmacct ON (prj.prj_crmacct_id = crmacct.crmacct_id)
WHERE qthead_ordtype = 'WO'
    AND qthead_ordnumber = &lt;? value("orderNumber") ?>
</sql>
 </querysource>
 <querysource>
  <name>detail</name>
  <sql>SELECT 
  qthead.qthead_id,
  qthead.qthead_number, 
  qphead.qphead_code, 
  qphead.qphead_descrip, 
  qphead.qphead_code ||' - '||qphead.qphead_descrip AS quality_plan, 
  formatDate(qthead.qthead_start_date) AS start_date, 
  formatDate(qthead.qthead_completed_date) AS completed_date, 
  CASE WHEN (qthead_status = 'O') THEN 'Open'
       WHEN (qthead_status = 'P') THEN  'Pass'
       WHEN (qthead_status = 'F') THEN  'Fail'
       ELSE 'Error' END AS test_status,
  CASE WHEN (qtitem_status = 'O') THEN 'Open'
       WHEN (qtitem_status = 'P') THEN  'Pass'
       WHEN (qtitem_status = 'F') THEN  'Fail'
       ELSE 'Error' END AS status,
  qtitem_description AS description,
  qtitem_instruction AS instruction,
  qtitem_actual ||' '||qtitem_uom AS result,
  qtitem_notes AS notes,     
  qtrsncode.qtrsncode_code,
  qtrlscode.qtrlscode_code,
  qthead.obj_uuid AS uuid,
  CASE WHEN (qtitem_status = 'O') THEN 'black'
       WHEN (qtitem_status = 'P') THEN  'green'
       WHEN (qtitem_status = 'F') THEN  'red'
       END AS status_qtforegroundrole
FROM 
  xt.qthead
  JOIN xt.qtitem ON (qthead.qthead_id = qtitem.qtitem_qthead_id)
  JOIN xt.qphead ON (qthead.qthead_qphead_id = qphead.qphead_id )
  LEFT OUTER JOIN xt.qtrsncode ON (qthead.qthead_rsncode_id = qtrsncode.qtrsncode_id) 
  LEFT OUTER JOIN xt.qtrlscode ON (qthead.qthead_rlscode_id = qtrlscode.qtrlscode_id) 
  LEFT OUTER JOIN item ON (qthead.qthead_item_id = item.item_id)
WHERE true
  AND qthead_ordnumber = &lt;? value("orderNumber") ?>
ORDER BY qthead.qthead_start_date, qthead.qthead_number</sql>
 </querysource>
 <querysource>
  <name>image</name>
  <sql>SELECT 1 as one,
       image_data
FROM imageass, image x
WHERE ( (imageass_image_id=image_id)
 AND (imageass_source='I')
 AND (imageass_source_id= (SELECT itemsite_item_id FROM itemsite, wo 
                 WHERE itemsite_id=wo_itemsite_id
                 AND wo_number||'-'||wo_subnumber = &lt;? value("orderNumber") ?>)) )
ORDER BY image_name;</sql>
 </querysource>
 <rpthead>
  <height>270</height>
  <rect>
   <x>490</x>
   <y>35</y>
   <width>230</width>
   <height>195</height>
   <weight>2</weight>
   <borderwidth>2</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>35</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>60</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>85</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>110</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>135</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>160</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <rect>
   <x>10</x>
   <y>185</y>
   <width>480</width>
   <height>25</height>
   <weight>1</weight>
   <borderwidth>1</borderwidth>
  </rect>
  <image>
   <rect>
    <x>495</x>
    <y>35</y>
    <width>225</width>
    <height>195</height>
   </rect>
   <mode>stretch</mode>
   <data>
    <query>image</query>
    <column>image_data</column>
   </data>
  </image>
  <label>
   <rect>
    <x>175</x>
    <y>0</y>
    <width>545</width>
    <height>35</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>20</size>
    <weight>bold</weight>
   </font>
   <right/>
   <top/>
   <string>Work Order Production Test Summary</string>
  </label>
  <label>
   <rect>
    <x>15</x>
    <y>40</y>
    <width>100</width>
    <height>25</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <top/>
   <string>Customer:</string>
  </label>
  <label>
   <rect>
    <x>15</x>
    <y>90</y>
    <width>100</width>
    <height>25</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <top/>
   <string>Project Name:</string>
  </label>
  <label>
   <rect>
    <x>15</x>
    <y>115</y>
    <width>100</width>
    <height>25</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <top/>
   <string>Item Code:</string>
  </label>
  <label>
   <rect>
    <x>15</x>
    <y>140</y>
    <width>130</width>
    <height>25</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <top/>
   <string>Item Description:</string>
  </label>
  <label>
   <rect>
    <x>15</x>
    <y>165</y>
    <width>145</width>
    <height>25</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <top/>
   <string>Work Order:</string>
  </label>
  <field>
   <rect>
    <x>95</x>
    <y>40</y>
    <width>385</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>head</query>
    <column>customer_number</column>
   </data>
  </field>
  <field>
   <rect>
    <x>120</x>
    <y>90</y>
    <width>365</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>head</query>
    <column>project_name</column>
   </data>
  </field>
  <field>
   <rect>
    <x>120</x>
    <y>115</y>
    <width>370</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>head</query>
    <column>item_number</column>
   </data>
  </field>
  <field>
   <rect>
    <x>145</x>
    <y>140</y>
    <width>340</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>head</query>
    <column>item_description</column>
   </data>
  </field>
  <field>
   <rect>
    <x>30</x>
    <y>65</y>
    <width>455</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>head</query>
    <column>customer</column>
   </data>
  </field>
  <field>
   <rect>
    <x>145</x>
    <y>165</y>
    <width>340</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>head</query>
    <column>work_order</column>
   </data>
  </field>
 </rpthead>
 <section>
  <name>detail</name>
  <group>
   <name>test</name>
   <column>qthead_number</column>
   <head>
    <height>85</height>
    <rect>
     <x>10</x>
     <y>58.2529</y>
     <width>710</width>
     <height>25</height>
     <weight>1</weight>
     <borderwidth>1</borderwidth>
    </rect>
    <label>
     <rect>
      <x>125</x>
      <y>65</y>
      <width>100</width>
      <height>25</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <left/>
     <top/>
     <string>Instructions</string>
    </label>
    <line>
     <xstart>600</xstart>
     <ystart>58.2529</ystart>
     <xend>600</xend>
     <yend>83.2529</yend>
     <weight>1</weight>
    </line>
    <line>
     <xstart>120</xstart>
     <ystart>58.2529</ystart>
     <xend>120</xend>
     <yend>83.2529</yend>
     <weight>1</weight>
    </line>
    <line>
     <xstart>490</xstart>
     <ystart>58.2529</ystart>
     <xend>490</xend>
     <yend>83.2529</yend>
     <weight>1</weight>
    </line>
    <label>
     <rect>
      <x>495</x>
      <y>65</y>
      <width>100</width>
      <height>25</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <left/>
     <top/>
     <string>Result</string>
    </label>
    <label>
     <rect>
      <x>605</x>
      <y>65</y>
      <width>45</width>
      <height>25</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <left/>
     <top/>
     <string>Notes</string>
    </label>
    <label>
     <rect>
      <x>15</x>
      <y>65</y>
      <width>100</width>
      <height>25</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <left/>
     <top/>
     <string>Test Item</string>
    </label>
    <label>
     <rect>
      <x>15</x>
      <y>10</y>
      <width>35</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <left/>
     <top/>
     <string>Test:</string>
    </label>
    <label>
     <rect>
      <x>265</x>
      <y>10</y>
      <width>55</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <right/>
     <top/>
     <string>Test Plan:</string>
    </label>
    <label>
     <rect>
      <x>15</x>
      <y>25</y>
      <width>90</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <left/>
     <top/>
     <string>Completed Date:</string>
    </label>
    <label>
     <rect>
      <x>230</x>
      <y>25</y>
      <width>90</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <right/>
     <top/>
     <string>Test Status:</string>
    </label>
    <label>
     <rect>
      <x>460</x>
      <y>25</y>
      <width>90</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <right/>
     <top/>
     <string>Release Code:</string>
    </label>
    <label>
     <rect>
      <x>460</x>
      <y>40</y>
      <width>90</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>bold</weight>
     </font>
     <right/>
     <top/>
     <string>Reason Code:</string>
    </label>
    <field>
     <rect>
      <x>45</x>
      <y>10</y>
      <width>100</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>normal</weight>
     </font>
     <left/>
     <top/>
     <data>
      <query>detail</query>
      <column>qthead_number</column>
     </data>
    </field>
    <field>
     <rect>
      <x>105</x>
      <y>25</y>
      <width>100</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>normal</weight>
     </font>
     <left/>
     <top/>
     <data>
      <query>detail</query>
      <column>completed_date</column>
     </data>
    </field>
    <field>
     <rect>
      <x>325</x>
      <y>10</y>
      <width>395</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>normal</weight>
     </font>
     <left/>
     <top/>
     <data>
      <query>detail</query>
      <column>quality_plan</column>
     </data>
    </field>
    <field>
     <rect>
      <x>325</x>
      <y>25</y>
      <width>100</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>normal</weight>
     </font>
     <left/>
     <top/>
     <data>
      <query>detail</query>
      <column>test_status</column>
     </data>
    </field>
    <field>
     <rect>
      <x>555</x>
      <y>25</y>
      <width>155</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>normal</weight>
     </font>
     <left/>
     <top/>
     <data>
      <query>detail</query>
      <column>qtrlscode_code</column>
     </data>
    </field>
    <field>
     <rect>
      <x>555</x>
      <y>40</y>
      <width>160</width>
      <height>15</height>
     </rect>
     <font>
      <face>Helvetica</face>
      <size>8</size>
      <weight>normal</weight>
     </font>
     <left/>
     <top/>
     <data>
      <query>detail</query>
      <column>qtrsncode_code</column>
     </data>
    </field>
    <line>
     <xstart>5</xstart>
     <ystart>5</ystart>
     <xend>715</xend>
     <yend>5</yend>
     <weight>2</weight>
    </line>
   </head>
  </group>
  <detail>
   <key>
    <query>detail</query>
   </key>
   <height>30</height>
   <field>
    <rect>
     <x>15</x>
     <y>5</y>
     <width>100</width>
     <height>15</height>
    </rect>
    <font>
     <face>Helvetica</face>
     <size>8</size>
     <weight>normal</weight>
    </font>
    <left/>
    <top/>
    <data>
     <query>detail</query>
     <column>description</column>
    </data>
   </field>
   <field>
    <rect>
     <x>495</x>
     <y>5</y>
     <width>100</width>
     <height>15</height>
    </rect>
    <font>
     <face>Helvetica</face>
     <size>8</size>
     <weight>normal</weight>
    </font>
    <left/>
    <top/>
    <data>
     <query>detail</query>
     <column>result</column>
    </data>
   </field>
   <field>
    <rect>
     <x>495</x>
     <y>15</y>
     <width>100</width>
     <height>15</height>
    </rect>
    <font>
     <face>Helvetica</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <top/>
    <data>
     <query>detail</query>
     <column>status</column>
    </data>
   </field>
   <text>
    <rect>
     <x>125</x>
     <y>5</y>
     <width>360</width>
     <height>15</height>
    </rect>
    <bottompad>0</bottompad>
    <font>
     <face>Helvetica</face>
     <size>8</size>
     <weight>normal</weight>
    </font>
    <left/>
    <top/>
    <data>
     <query>detail</query>
     <column>instruction</column>
    </data>
   </text>
   <text>
    <rect>
     <x>605</x>
     <y>5</y>
     <width>110</width>
     <height>15</height>
    </rect>
    <bottompad>0</bottompad>
    <font>
     <face>Helvetica</face>
     <size>8</size>
     <weight>normal</weight>
    </font>
    <left/>
    <top/>
    <data>
     <query>detail</query>
     <column>notes</column>
    </data>
   </text>
  </detail>
 </section>
 <pgfoot>
  <height>70</height>
  <label>
   <rect>
    <x>10</x>
    <y>15</y>
    <width>115</width>
    <height>20</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <top/>
   <string>QC Signature:</string>
  </label>
  <line>
   <xstart>10</xstart>
   <ystart>10</ystart>
   <xend>720</xend>
   <yend>10</yend>
   <weight>2</weight>
  </line>
  <label>
   <rect>
    <x>475</x>
    <y>15</y>
    <width>135</width>
    <height>25</height>
   </rect>
   <font>
    <face>Helvetica</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <right/>
   <top/>
   <string>Date:</string>
  </label>
 </pgfoot>
 <rptfoot>
  <height>100</height>
 </rptfoot>
</report>
