 alter table xwd.catalog drop column catalog_ps_pik;
 alter table xwd.catalog drop column catalog_item_action;
 alter table xwd.catalog drop column catalog_item_num;
 alter table xwd.catalog drop column catalog_pkg_indicator;
 alter table xwd.catalog drop column catalog_ean;
 alter table xwd.catalog drop column catalog_unspsc;
 alter table xwd.catalog drop column catalog_user_num;
 alter table xwd.catalog drop column catalog_zone;
 alter table xwd.catalog drop column catalog_zone_pik;
 alter table xwd.catalog drop column catalog_item_country;
 alter table xwd.catalog drop column catalog_item_industry;
 alter table xwd.catalog drop column catalog_upc_flag;
 alter table xwd.catalog drop column catalog_replaced_by_item_pik;
 alter table xwd.catalog drop column catalog_replaces_item_pik;
 alter table xwd.catalog drop column catalog_mfr_type;
 alter table xwd.catalog drop column catalog_i2_cat_num;
 alter table xwd.catalog drop column catalog_fulltech_description;
 alter table xwd.catalog drop column catalog_invoice_description;
 alter table xwd.catalog drop column catalog_ps_product_group;
 alter table xwd.catalog drop column catalog_cash_discount;
 alter table xwd.catalog drop column catalog_velocity_code;
 alter table xwd.catalog drop column catalog_ps_lgcy_dscnt_schd;
 alter table xwd.catalog drop column catalog_gst_flag;
 alter table xwd.catalog drop column catalog_ps_lgcy_low_dollar;
 alter table xwd.catalog drop column catalog_ps_lgcy_high_dollar;
 alter table xwd.catalog drop column catalog_ps_lgcy_qty2;
 alter table xwd.catalog drop column catalog_ps_lgcy_qty3;
 alter table xwd.catalog drop column catalog_ps_lgcy_uom;
 alter table xwd.catalog drop column catalogps_uom_qty;
 alter table xwd.catalog drop column catalog_price_src_name;
 alter table xwd.catalog drop column catalog_price_status;
 alter table xwd.catalog drop column catalog_price_eff_date;
 alter table xwd.catalog drop column catalog_price_end_date;
 alter table xwd.catalog drop column catalog_col1;
 alter table xwd.catalog drop column catalog_col2;
 alter table xwd.catalog drop column catalog_resale;
 alter table xwd.catalog drop column catalog_cost;
 alter table xwd.catalog drop column catalog_custom_price2;
 alter table xwd.catalog drop column catalog_custom_price3;
 alter table xwd.catalog drop column catalog_pkg_weight_uom;
 alter table xwd.catalog drop column catalog_pkg_type;
 alter table xwd.catalog drop column catalog_msds;
 alter table xwd.catalog drop column catalog_msds_eff_date;
 alter table xwd.catalog drop column catalog_msds_form_num;
 alter table xwd.catalog drop column catalog_ps_dscnt_schd_code;
 alter table xwd.catalog drop column catalog_mfr_pik;
 alter table xwd.catalog drop column catalog_mfr_registered_ucc_flag;
 alter table xwd.catalog drop column catalog_leaf_class;
 alter table xwd.catalog drop column catalog_unspsc40;
 alter table xwd.catalog drop column catalog_pfms_description;
 alter table xwd.catalog drop column catalog_pfms_mfr_shortname;
 alter table xwd.catalog drop column catalog_xref_group;
 alter table xwd.catalog drop column catalog_custom_price1_uom;
 alter table xwd.catalog drop column catalog_custom_price2_uom;
 alter table xwd.catalog drop column catalog_custom_price3_uom;
 alter table xwd.catalog drop column catalog_mfr_class_code;
 alter table xwd.catalog drop column catalog_mfr_sub_class_code;
 alter table xwd.catalog drop column catalog_price_group_code1;
 alter table xwd.catalog drop column catalog_price_group_code2;
 alter table xwd.catalog drop column catalog_price_group_code3;
 alter table xwd.catalog drop column catalog_stock_indicator;
 alter table xwd.catalog drop column catalog_brand_name;
 alter table xwd.catalog drop column catalog_indv_weight_uom;
 alter table xwd.catalog drop column catalog_mfr_replaced_by_upc;
 alter table xwd.catalog drop column catalog_mfr_replaced_by_cat_no;
 alter table xwd.catalog drop column catalog_mfr_replaces_upc;
 alter table xwd.catalog drop column catalog_mfr_replaces_cat_no;
 alter table xwd.catalog drop column catalog_pkg_length;
 alter table xwd.catalog drop column catalog_pkg_width;
 alter table xwd.catalog drop column catalog_pkg_height;
 alter table xwd.catalog drop column catalog_pkg_volume;
 alter table xwd.catalog drop column catalog_pkg_dmnsn_uom;
 alter table xwd.catalog drop column catalog_pkg_volume_uom;
 alter table xwd.catalog drop column catalog_comm_code_enhanced;
 alter table xwd.catalog drop column catalog_comm_pik_enhanced;
 alter table xwd.catalog drop column catalog_currency_code;
 alter table xwd.catalog drop column catalog_gtin;
 alter table xwd.catalog drop column catalog_legacy_update_status;
 alter table xwd.catalog drop column catalog_item_update_status;
 alter table xwd.catalog drop column catalog_price_update_status;
 alter table xwd.catalog drop column catalog_mfr_item_status;
 alter table xwd.catalog drop column catalog_mfr_unspsc;
 alter table xwd.catalog drop column catalog_energy_star;
 alter table xwd.catalog drop column catalog_min_advertised_price;
 alter table xwd.catalog drop column catalog_trade_qty1;
 alter table xwd.catalog drop column catalog_trade_price1;
 alter table xwd.catalog drop column catalog_trade_qty2;
 alter table xwd.catalog drop column catalog_trade_price2;
 alter table xwd.catalog drop column catalog_trade_qty3;
 alter table xwd.catalog drop column catalog_trade_price3;
 alter table xwd.catalog drop column catalog_trade_qty4;
 alter table xwd.catalog drop column catalog_trade_price4;
 alter table xwd.catalog drop column catalog_trade_qty5;
 alter table xwd.catalog drop column catalog_trade_price5;
 alter table xwd.catalog drop column catalog_trade_qty6;
 alter table xwd.catalog drop column catalog_trade_price6;
 alter table xwd.catalog drop column catalog_trade_qty7;
 alter table xwd.catalog drop column catalog_trade_price7;
 alter table xwd.catalog drop column catalog_trade_qty8;
 alter table xwd.catalog drop column catalog_trade_price8;
 alter table xwd.catalog drop column catalog_trade_qty9;
 alter table xwd.catalog drop column catalog_trade_price9;
 alter table xwd.catalog drop column catalog_trade_qty10;
 alter table xwd.catalog drop column catalog_trade_price10;
 alter table xwd.catalog drop column catalog_cost_qty1;
 alter table xwd.catalog drop column catalog_cost_price1;
 alter table xwd.catalog drop column catalog_cost_qty2;
 alter table xwd.catalog drop column catalog_cost_price2;
 alter table xwd.catalog drop column catalog_cost_qty3;
 alter table xwd.catalog drop column catalog_cost_price3;
 alter table xwd.catalog drop column catalog_cost_qty4;
 alter table xwd.catalog drop column catalog_cost_price4;
 alter table xwd.catalog drop column catalog_cost_qty5;
 alter table xwd.catalog drop column catalog_cost_price5;
 alter table xwd.catalog drop column catalog_cost_qty6;
 alter table xwd.catalog drop column catalog_cost_price6;
 alter table xwd.catalog drop column catalog_cost_qty7;
 alter table xwd.catalog drop column catalog_cost_price7;
 alter table xwd.catalog drop column catalog_cost_qty8;
 alter table xwd.catalog drop column catalog_cost_price8;
 alter table xwd.catalog drop column catalog_cost_qty9;
 alter table xwd.catalog drop column catalog_cost_price9;
 alter table xwd.catalog drop column catalog_cost_qty10;
 alter table xwd.catalog drop column catalog_cost_price10;
 alter table xwd.catalog drop column catalog_country_of_origin;
 alter table xwd.catalog drop column catalog_percnet_mfgd_in_usa;
 alter table xwd.catalog drop column catalog_indv_weight_qty;
 alter table xwd.catalog drop column catalog_indv_weight_qty_uom;
 alter table xwd.catalog drop column catalog_alt_mfr_cat_number;
 alter table xwd.catalog drop column catalog_lead_free_flag;
 alter table xwd.catalog drop column catalog_mercury_free_flag;

DROP INDEX catalog_mfr_fullname_idx;
DROP INDEX catalog_mfr_cat_num_idx;
DROP INDEX catalog_product_name_idx;
DROP INDEX catalog_2k_desc_idx;

CREATE INDEX catalog_upper_mfr_fullname_idx ON xwd.catalog USING btree (UPPER(catalog_mfr_fullname));
CREATE INDEX catalog_upper_product_name_idx ON xwd.catalog USING btree (UPPER(catalog_product_name));
CREATE INDEX catalog_item_pik_idx ON xwd.catalog USING btree (catalog_item_pik);

 alter table xwd.catalog add column catalog_pdf_url TEXT;
 alter table xwd.catalog add column catalog_web_url TEXT;

CREATE OR REPLACE FUNCTION xwd.mergeCatimage() RETURNS INTEGER AS $$
DECLARE
  _r RECORD;
  _result INTEGER := 0;

BEGIN

  FOR _r IN
    SELECT * FROM xwd.catimage
  LOOP
    UPDATE xwd.catalog SET catalog_pdf_url=_r.catimage_pdf_url,
                           catalog_web_url=_r.catimage_web_url
    WHERE (catalog_item_pik=_r.catimage_item_pik);
  END LOOP;

  RETURN _result;
END;
$$ LANGUAGE 'plpgsql';

 select xwd.mergeCatimage();
 drop function xwd.mergeCatimage();
 drop table xwd.catimage;
